<!doctype html><style>body{display:flex;justify-content:center;align-items:center}#game{display:inline-block;display:flex;flex-direction:row;gap:5px}.panel{border-radius:10px}#field{padding:10px;background:green;display:inline-block}#board{display:flex;flex-direction:column;gap:2px}.fieldCell{width:40px;height:40px;background:#9acd32;border-radius:2px;font-size:15px;color:#fff;align-items:center;justify-content:center}.fieldCell:hover{box-shadow:inset 0 0 0 2px #000}.fieldCellRow{display:flex;flex-direction:row;gap:2px}.fieldCellCol{display:flex}#control{width:200px;flex:1;background:green;padding:10px;gap:10px;display:flex;flex-direction:column}#debug{width:500px;height:500px;border:2px solid #000;white-space:pre-wrap;overflow-y:auto}#info{flex:1;padding:10px;background:#9acd32;gap:10px}#showLevel{width:auto;height:50px;display:flex;align-items:center;justify-content:center}#next{width:auto;height:50px}.btn{border:2px solid #000;padding:auto;display:flex;align-items:center;justify-content:center;background:#9acd32}.btn:hover{background:green}.selectedBtn{border:2px solid #000;padding:auto;display:none;align-items:center;justify-content:center;background:#9acd32;margin-top:10px}.selectedBtn:hover{background:green}.title{font-size:20px;font-weight:700}</style><div id=game><div id=field class=panel><div id=board></div></div><div id=control class=panel><div id=info class=panel><div class=title>Infomation</div><div>Day:</div><div>Energy:</div><div>Bio resource:</div><div>Mineral resource:</div><div class=title>Selected</div><div>Position:</div><div>Type:</div><div class=title>Actions</div><div id=search class="panel selectedBtn" onclick=search(event)>search</div><div id=build class="panel selectedBtn" onclick=build(event)>build</div><div id=deploy class="panel selectedBtn" onclick=deploy(event)>deploy</div></div><div id=showLevel class="panel btn" onclick=showLevel(event)>Show Level: OFF</div><div id=next class="panel btn">End Turn</div></div><div id=debug class=panel></div></div><script>const BOARD_ROW=16,BOARD_COL=16;let showLabe=!1;const IS_FOG=!0,boardDiv=document.getElementById("board"),controlDiv=document.getElementById("control"),debugDiv=document.getElementById("debug"),cells=document.getElementsByClassName("fieldCell"),searchDiv=document.getElementById("search"),buildDiv=document.getElementById("build"),deployDiv=document.getElementById("deploy");let fieldData=[],gameData={selected:[14,14]};const pollutionPosition=[[1,1],[2,3],[3,3],[4,2],[5,10],[3,10],[15,4],[12,10],[14,3],[2,14],[10,4],[6,12]],playerBaseSetting=[[14,14]];function handleClick(e){selectAction(splitId(e.target.id)),debugMessage()}function handleMouseover(e){hoverAction(splitId(e.target.id)),debugMessage()}function handleMouseout(e){e.target}function selectAction(e){const t=fieldData[e[0]][e[1]];gameData.selected={position:e,data:t},t.isFog?(searchDiv.style.display="flex",deployDiv.style.display="none",buildDiv.style.display="none"):"tree"===t.type||"mine"===t.type||"pollution"===t.type?(searchDiv.style.display="none",deployDiv.style.display="none",buildDiv.style.display="flex"):(searchDiv.style.display="none",deployDiv.style.display="flex",buildDiv.style.display="none")}function hoverAction(e){}function search(){recusiveSearch(gameData.selected.position),reDraw()}function recusiveSearch(e){const t=fieldData[e[0]][e[1]];if(t.isFog)if(t.isFog=!1,"wasteland"===t.type){around(e).forEach((e=>{recusiveSearch(e)}))}else if("tree"===t.type||"mine"===t.type){around(e,t[t.type].level-1).forEach((e=>{0===fieldData[e[0]][e[1]].pollute.level&&recusiveSearch(e)}))}else{if("pollution"!==t.type)return;around(e,t.pollution.level-1).forEach((e=>{fieldData[e[0]][e[1]];recusiveSearch(e)}))}}function renderDiffusion(){for(let e=0;e<BOARD_ROW;e++)for(let t=0;t<BOARD_COL;t++){const l=fieldData[e][t];"pollution"===l.type&&diffusion(e,t,l.pollution.level,(e=>{fieldData[e[0]][e[1]].pollute.level++})),"tree"===l.type&&diffusion(e,t,l.tree.level,(e=>{fieldData[e[0]][e[1]].bio.level++})),"mine"===l.type&&diffusion(e,t,l.mine.level,(e=>{fieldData[e[0]][e[1]].mineral.level++}))}}function diffusion(e,t,l,n){for(let o=l-1;o>0;o--){around([e,t],o).forEach((e=>{n(e)}))}}function setPollution(e=1){pollutionPosition.forEach((t=>{fieldData[t[0]][t[1]].type="pollution",fieldData[t[0]][t[1]].pollution={level:e}}))}function setPlayerBase(){playerBaseSetting.forEach((e=>{fieldData[e[0]][e[1]].type="base",fieldData[e[0]][e[1]].isFog=!1}))}function around(e,t=1){const l=-1*t,n=t,o=BOARD_ROW,a=BOARD_COL,i=[];for(let t=l;t<=n;t++){const r=e[0]+t;for(let t=l;t<=n;t++){const l=e[1]+t;r>=0&&r<o&&l>=0&&l<a&&i.push([r,l])}}return i}function setTreeAndRock(){[[10,14]].forEach((e=>{fieldData[e[0]][e[1]].type="tree",fieldData[e[0]][e[1]].tree={level:3}}));renderPos(10).forEach((e=>{fieldData[e[0]][e[1]].type="tree",fieldData[e[0]][e[1]].tree={level:2}}));renderPos(5).forEach((e=>{fieldData[e[0]][e[1]].type="mine",fieldData[e[0]][e[1]].mine={level:2}}))}function renderPos(e){const t=[];let l=0;for(;l<e;){const e=Math.floor(Math.random()*BOARD_ROW),n=Math.floor(Math.random()*BOARD_COL),o=`${e},${n}`;"wasteland"!==fieldData[e][n].type||t.includes(o)||(t.push(o),l++)}return t.map((e=>e.split(",")))}function initFieldData(){for(let e=0;e<BOARD_ROW;e++){const t=[];for(let l=0;l<BOARD_COL;l++)t.push({name:`fieldCell_${e}_${l}`,type:"wasteland",isFog:!0,pollute:{level:0},bio:{level:0},mineral:{level:0}});fieldData.push(t)}}function generateField(e){for(let t=0;t<e.length;t++){const l=e[t],n=document.createElement("div");n.classList.add("fieldCellRow");for(let e=0;e<l.length;e++){const t=l[e],o=document.createElement("div");o.id=t.name,o.classList.add("fieldCell"),o.classList.add("fieldCellCol"),drawField(t,o),n.appendChild(o)}boardDiv.appendChild(n)}}function reDraw(){for(let e=0;e<BOARD_ROW;e++)for(let t=0;t<BOARD_COL;t++){drawField(fieldData[e][t],document.getElementById(fieldData[e][t].name))}}function drawField(e,t){switch(e.type){case"pollution":t.style.background="black",showLabe&&!e.isFog?t.innerHTML=e.pollution.level:t.innerHTML="";break;case"base":t.style.background="red";break;case"tree":t.style.background="green",showLabe&&!e.isFog?t.innerHTML=e.tree.level:t.innerHTML="";break;case"mine":t.style.background="gray",showLabe&&!e.isFog?t.innerHTML=e.mine.level:t.innerHTML="";break;default:e.pollute.level>0?(e.type="pollute",t.style.background=purpleLevel(e.pollute.level),showLabe&&!e.isFog?t.innerHTML=e.pollute.level:t.innerHTML=""):e.bio.level>0?(e.type="grass",t.style.background="yellowgreen",showLabe&&!e.isFog?t.innerHTML=e.bio.level:t.innerHTML=""):e.mineral.level>0?(e.type="rock",t.style.background="darkgrey",showLabe&&!e.isFog?t.innerHTML=e.mineral.level:t.innerHTML=""):(e.type="wasteland",t.style.background="burlywood")}IS_FOG&&e.isFog&&(t.style.background="blue")}function purpleLevel(e){return e<=1?"rgb(186,85,255)":e<=2?"rgb(162,25,255)":e<=4?"rgb(119,0,200)":e<=8?"rgb(95,0,160)":"rgb(60,0,100)"}function splitId(e){const t=e.split("_");return[Number(t[1]),Number(t[2])]}function debugMessage(){const e={gameData:gameData,showData:showData()};debugDiv.innerHTML=JSON.stringify(e,null,2)}function showData(){const e=gameData.selected.position,t={pollution:0,pollute:0,tree:0,mine:0,selectedData:fieldData[e[0]][e[1]]};for(let e=0;e<BOARD_ROW;e++)for(let l=0;l<BOARD_COL;l++){const n=fieldData[e][l];"pollution"===n.type?t.pollution++:"pollute"===n.type?t.pollute++:"tree"===n.type?t.tree++:"mine"===n.type&&t.mine++}return t}function showLevel(e){showLabe=!showLabe,e.target.innerHTML="Show Level: "+(showLabe?"ON":"OFF"),reDraw()}initFieldData(),setPollution(2),setPlayerBase(),setTreeAndRock(),renderDiffusion(),generateField(fieldData),Array.from(cells).forEach((e=>{e.addEventListener("click",handleClick),e.addEventListener("mouseover",handleMouseover),e.addEventListener("mouseout",handleMouseout)}))</script>
